Search.setIndex({docnames:["CONCEPTS/parallel_context","CONCEPTS/tensor_model_parallelism","CONCEPTS/tp/1d_parallel_algorithm","CONCEPTS/tp/2d_parallel_algorithm","CONCEPTS/tp/2p5d_parallel_algorithm","CONCEPTS/tp/3d_parallel_algorithm","TUTORIALS/tensor_model_parallelism","index"],envversion:{"sphinx.domains.c":2,"sphinx.domains.changeset":1,"sphinx.domains.citation":1,"sphinx.domains.cpp":3,"sphinx.domains.index":1,"sphinx.domains.javascript":2,"sphinx.domains.math":2,"sphinx.domains.python":2,"sphinx.domains.rst":2,"sphinx.domains.std":2,"sphinx.ext.intersphinx":1,"sphinx.ext.todo":2,"sphinx.ext.viewcode":1,sphinx:56},filenames:["CONCEPTS/parallel_context.md","CONCEPTS/tensor_model_parallelism.md","CONCEPTS/tp/1d_parallel_algorithm.md","CONCEPTS/tp/2d_parallel_algorithm.md","CONCEPTS/tp/2p5d_parallel_algorithm.md","CONCEPTS/tp/3d_parallel_algorithm.md","TUTORIALS/tensor_model_parallelism.md","index.rst"],objects:{},objnames:{},objtypes:{},terms:{"05343":3,"08053":2,"100":6,"14450":5,"14500":4,"1909":2,"2021":7,"2022":7,"2104":3,"2105":[4,5],"2p5d":6,"64gb":6,"case":0,"class":0,"enum":0,"export":6,"final":5,"function":[0,6],"import":[0,2,3,4,5,6],"super":1,"true":6,"while":5,And:6,For:[2,3,6],Not:6,The:[3,4,7],Then:6,There:[0,6],Use:[2,3,4,5],Using:[1,6],_ep_:6,_pp_:6,about:6,across:2,activ:3,adam:6,add:6,addit:6,address:[3,4,5],algorithm:7,all:[2,7],along:[2,5],also:[2,3,4,5,6],among:[2,5],apach:7,appli:4,approach:4,argument:6,arxiv:[2,3,4,5],assign:6,author:[1,2,3,4,5,6,7],automodelforcausallm:6,autotoken:6,backward:6,base:[3,4,5,7],bash:6,batch:6,batch_siz:6,becaus:[3,6],been:5,being:7,between:6,billion:[1,2],bin:6,both:5,broadcast:3,calcul:3,call:6,can:[0,2,3,4,6,7],capabl:5,care:7,challeng:5,check:7,christma:6,chunk:2,classif:6,cluster:[2,5],code:[6,7],column:[2,3,5,6],com:7,combin:4,command:6,commun:[4,5,6],compat:7,comput:[2,3,4,5],concept:6,consid:7,consumpt:3,context:[6,7],copyright:7,core:7,cost:[4,5,6],could:7,count_nod:6,cpu:6,creat:7,cubic:6,cuda:6,data:[0,6],data_parallel_rank:0,data_parallel_s:[0,2,3,4,5,6],decod:6,decreas:7,deep:1,deepspe:6,defin:[2,4,5,6],democrat:7,depth:[],design:5,desir:0,detail:6,devic:[2,4,5,7],differ:[2,6],difficulti:7,dimens:[1,2,5,6],dimension:1,distribut:[0,1,2,3],divid:5,document:6,doe:3,doesn:6,don:6,done:3,each:[2,4,6],easi:7,easili:7,effect:6,effici:[1,3,6],eleutherai:7,enumer:6,environ:6,eos_token:6,ep_rank:6,equal:6,evenli:3,exampl:[2,6],expert:0,expert_parallel_s:0,explain:6,expoert_parallel_rank:0,expoert_parallel_s:0,face:[6,7],facto:7,fashion:2,featur:7,field:7,file:6,find:[6,7],follow:6,forward:[6,7],four:3,framework:7,from:[0,2,3,4,5,6],from_pretrain:6,from_torch:[2,3,4,5,6],further:5,fusion:7,gener:6,get_local_rank:0,get_world_s:0,github:7,global:0,global_rank:0,global_s:0,going:6,gpt2:6,gpu:[2,5,6,7],gre:6,group:0,har:5,has:[4,5],have:[5,6],head:6,here:6,high:3,host:0,hostnam:6,how:6,howpublish:7,http:[2,3,4,5,7],hug:[6,7],huge:1,ident:4,increas:4,infinit:6,inform:6,input:[0,2,3,4,5],input_batch:6,input_id:6,instal:6,instanc:3,introduc:[3,5],involv:[4,5],issu:3,job:6,jobnam:6,just:6,kei:7,kernel:7,kevin:[1,2,3,4,5,6],kichang:[1,2,3,4,5,6],label:6,languag:[1,2],larg:[1,2,3,5],larger:[1,6],later:6,launch:6,launcher:0,layer:[2,3,4,5,6],lead:3,learn:1,librari:6,like:[6,7],likewis:6,limit:5,linear:[2,3,4],load:[2,3],load_dataset:6,local:6,look:7,loss:6,lot:6,lower:[4,6],magic:7,make:[1,6,7],manag:[0,7],mask:6,master_addr:6,master_port:6,matric:[3,4],matrix:[3,4],max_length:6,maxim:1,megatron:[1,6],megatronlm:6,mem:6,memori:[2,3,4,5],merge_checkpoint:6,method:[0,1,6],misc:7,mix:6,mode:6,model:[2,3,4,5,7],modifi:6,more:[1,3,4,5,6,7],much:6,multi:1,multipl:[1,2,5,6],must:[0,5,6],name:[0,6,7],natur:5,network:[1,5],neural:[1,5],nlp:7,nnode:6,node_rank:6,note:6,nproc_per_nod:6,ntask:6,num:6,num_beam:6,num_gpu:6,number:[5,6],object:7,one:[2,5,6],onli:[2,3,5,6],openmpi:0,oper:[2,4],org:[2,3,4,5],oslo:[0,2,3,4,5,6],other:4,our:7,output:4,packag:7,pad:6,pad_token:6,paper:[2,3,4,5],parallel:7,parallel_ckpt:6,parallel_context:[0,2,3,4,5,6],parallelcontext:[0,2,3,4,5,6],parallelmod:[0,2,3,4,5,6],paramet:[1,2,3,4,5,6],partit:[1,2,3,6],pass:6,path:6,pdf:[2,3,4,5],per:6,pip:7,pipelin:0,pipeline_parallel_rank:0,pipeline_parallel_s:[0,2,3,4,5,6],pleas:7,point:6,port:[0,6],pose:5,posit:6,possibl:[1,6],power:6,pp_rank:6,pretrain:[],previous:5,print:6,process:0,product:3,project:7,propos:[4,5],provid:7,put:0,pypi:7,python:6,pytorch:[0,6],pytorch_model_tp_:6,rank:7,readi:[2,3,4,5,6],recommend:6,reduc:[2,4,5],refer:6,request:6,requir:6,reserv:7,result:[3,4],return_tensor:6,right:7,row:[2,3,5,6],run:6,same:[1,6],save_directori:6,save_interv:6,save_pretrain:6,sbatch:6,sbatch_fil:6,scale:[2,3],scontrol:6,section:[2,4,5,6],see:6,seq_len:6,sequenc:[0,6],sequence_parallel_rank:0,sequence_parallel_s:0,should:[2,3,4,5,6],show:6,shuffl:6,significantli:7,similar:[0,6],simpli:6,singl:[5,6],size:7,slurm:[0,6],slurm_job_nodelist:6,smaller:[2,4,6],split:[2,3,4,5,6],squad:6,srun:6,standard:7,statu:6,step:[3,6],str:6,sub:[3,4,5],summa:[1,5,6],support:[1,6],task:6,techniqu:[2,5],technolog:7,tensor:[0,2,3,4,5,7],tensor_1d:[2,6],tensor_2d:[3,6],tensor_2p5d:[4,6],tensor_3d:[5,6],tensor_parallel:6,tensor_parallel_depth:[4,6],tensor_parallel_mod:[2,3,4,5,6],tensor_parallel_rank:0,tensor_parallel_s:[0,2,3,4,5,6],tensorparallel:[2,3,4,5,6],term:7,text:6,than:[4,6],them:2,thi:[0,3,4,5,6],thing:6,three:[0,5,6],time:6,titl:7,togeth:0,torch:[0,2,3,4,5,6],torchrun:6,total:6,tp_depth:[2,3,4,5,6],tp_rank:6,tp_size:[2,3,4,5,6],train:[1,2,7],train_step:6,transform:[6,7],truncat:6,turn:3,two:3,type:6,under:7,unlik:6,url:7,use:[0,3,4,6,7],used:[4,6],useful:7,uses:2,using:[0,2,4,5,6,7],util:6,variou:[6,7],version:6,want:6,warn:6,weight:[2,3,4,5],when:[3,7],which:[1,4,5,6,7],work:[6,7],world:7,world_siz:6,write:6,xa_i:2,xai:[],y_i:2,yang:[1,2,3,4,5,6],year:7,you:[0,2,3,4,5,6,7],your:6,your_host:0,your_node_address:6,your_port:0,your_script:6,zero_grad:6},titles:["Concept of Parallel Context","Concept of Tensor Model Parallelism","1D parallel algorithm (same as Megatron-LM)","2D parallel (SUMMA) algorithm","2.5D parallel (SUMMA-2.5) algorithm","3D parallel Algorithm","Tensor Model Parallelism Tutorial","OSLO: Open Source for Large-scale Optimization"],titleterms:{about:7,administr:7,algorithm:[1,2,3,4,5,6],appendix:6,check:0,checkpoint:6,cite:7,concept:[0,1,7],content:6,context:0,creat:[0,6],dataload:6,dataset:6,devic:0,distribut:6,document:7,easili:0,from_openmpi:0,from_slurm:0,from_torch:0,infer:6,initi:6,instal:7,larg:7,launcher:6,licens:7,load:6,megatron:2,merg:6,model:[1,6],multi:6,node:6,note:7,object:0,open:7,optim:[6,7],oslo:7,parallel:[0,1,2,3,4,5,6],rank:0,refer:1,same:2,save:6,scale:7,size:0,some:6,sourc:7,summa:[3,4],tabl:6,tensor:[1,6],token:6,train:6,tutori:[6,7],usag:[2,3,4,5],usual:6,variabl:6,what:7,world:0}})